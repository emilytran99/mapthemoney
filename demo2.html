<!DOCTYPE html>
<html>
<head>
	<title>Dsnap - Charts</title>
	<style>
	#xaxis .domain {
		fill:none;
		stroke:#000;
	}
	#xaxis text, #yaxis text {
		font-size: 12px;
	}
	</style>
</head>
<body>
	<div id="wrapper">
	</div>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<script>

		d3.csv("donors.csv", function(error, data) {
			data.forEach(function(d) {
				d.amount = +d.amount;
			});
			makeGraph(data);

		});

		var categories= ['','Accessories', 'Audiophile', 'Camera & Photo', 'Cell Phones', 'Computers','eBook Readers','Gadgets','GPS & Navigation','Home Audio','Office Electronics','Portable Audio','Portable Video','Security & Surveillance','Service','Television & Video','Car & Vehicle'];

		var dollars = [213,209,190,179,156,209,190,179,213,209,190,179,156,209,190,190];

		function makeGraph(data)
		{
			var colors = ['red','blue'];

			var grid = d3.range(25).map(function(i){
				return {'x1':0,'y1':0,'x2':0,'y2':480}; //how tall grid marks?
			});

			var tickVals = grid.map(function(d,i){
				if(i>0){ return i*10; }
				else if(i===0){ return "100";}
			});

			var xscale = d3.scale.linear()
							.domain([0, d3.max(data, (d)=>{return d.amount})]) //values
							.range([0,722]); // pixels

			var yscale = d3.scale.linear()
							.domain([0,data.length])
							.range([0,480]); // how tall

			var colorScale = d3.scale.linear()
							.domain([0,data.length])
							.range(colors);

			var canvas = d3.select('#wrapper')
							.append('svg')
							.attr({'width':900,'height':550});


			var	xAxis = d3.svg.axis();
				xAxis
					.orient('bottom')
					.scale(xscale)
					.tickValues(tickVals);

			var	yAxis = d3.svg.axis();
				yAxis
					.orient('left')
					.scale(yscale)
					.tickSize(2)
					.tickFormat(function(d,i){ console.log(i);return data[i].donor; })
					.tickValues(d3.range(data.length));

			var y_xis = canvas.append('g')
							  .attr("transform", "translate(150,0)")
							  .attr('id','yaxis')
							  .call(yAxis);

			var x_xis = canvas.append('g')
							  .attr("transform", "translate(150,480)")
							  .attr('id','xaxis')
							  .call(xAxis);

			var chart = canvas.append('g')
								.attr("transform", "translate(150,0)")
								.attr('id','bars')
								.selectAll('rect')
								.data(data)
								.enter()
								.append('rect')
								.attr('height',19)
								.attr({'x':0,'y':function(d,i){ return yscale(i)+19; }}) //how spread out things are
								.style('fill',function(d,i){ return colorScale(i); })
							 	.attr("width", function(d) {return xscale(d.amount); })
								.append('title')
								.text((d)=>{return d.donor;});
		}


	</script>
</body>
</html>
